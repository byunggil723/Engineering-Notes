# 근거리 통신 기술

### 근거리 통신 프로토콜

1\) CSMA (Carrier Sense Multiple Access)

여러 장치가 하나의 전송 채널을 공유할 때, 송신 전에 먼저 채널이 사용 중인지(신호가 존재하는지) 확인하고 채널이 비어 있으면 전송하며, 채널이 바쁘면 기다렸다가 다시 시도하는 방식이다.<br>
다만 채널이 비어 있다는 판단이 동시에 내려질 수 있기 때문에 여러 노드가 거의 같은 시점에 전송을 시작하면 충돌이 발생할 수 있고, 이 경우 각 노드는 랜덤 대기 시간(backoff)을 가진 뒤 재전송을 시도한다.

\* 매체(media): 데이터 신호가 물리적으로 지나가는 통로<br>
유선 매체: UTP, 광섬유<br>
무선 매체: 공기, 전자기파가 전파되는 매질<br> \* 채널(channel): 통신이 이루어지는 공유 자원(주파수 대역/시간/식별 코드 등)<br> \* 캐리어(carrier, 반송파): 채널 위에 실제로 올라와 있는 송신 신호(에너지/전압)<br> \* carrier sense: 지금 채널에 다른 송신 신호가 존재하는지(= 채널이 사용 중인지) 물리적으로 감지하는 행위<br> \* 매체에 따른 Carrier Sensing 방식<br>
유선: 해당 선로에 다른 프레임 신호(전압/파형) 존재 여부로 판단<br>
무선: 해당 채널 대역에 에너지 존재 여부로 판단<br>

2\) CSMA/CD (CSMA with Collision Detection)

CSMA/CD는 기본적으로 CSMA의 절차를 따르되, 송신 중에도 채널을 지속적으로 감시하여 충돌 발생 여부를 탐지한다.<br>
만약 충돌이 감지되면 즉시 전송을 중단하고, 송신 측은 충돌이 발생했음을 같은 공유 매체(선로)에 연결된 모든 노드가 확실히 인지하도록 Jam Signal을 선로에 전송한다.<br>
Jam Signal을 감지한 노드들은 채널이 충돌 상태(또는 혼잡 상태)임을 인지하고 전송을 중지한 뒤, 채널이 안정화되면 다시 전송을 시도한다.<br>
또한 충돌을 일으킨 송신 측은 동일한 시점에 재시도하여 충돌이 반복되는 상황을 방지하기 위해, 랜덤 백오프를 가진 후 재전송을 수행한다.<br>
이러한 충돌 감지는 송신 중인 신호와 채널에서 관측되는 신호의 불일치를 통해 가능하므로, CSMA/CD는 주로 유선 환경에서 사용된다.

3\) CSMA/CA (CSMA with Collision Avoidance)

CSMA/CA는 무선 환경처럼 송신 중 충돌 감지가 어려운 상황에서, 사전에 충돌을 최대한 회피하도록 설계된 방식이다.<br>
노드는 채널이 비어 있음을 확인하더라도 즉시 전송하지 않고 DIFS만큼 대기한 뒤, 랜덤 백오프 값을 선택하여 슬롯 시간(Slot Time) 단위로 카운트다운을 진행한다.<br>
카운트다운 도중 다른 노드가 전송을 시작해 채널이 바빠지면 카운트다운을 멈추고 대기하며, 채널이 다시 비면 남은 카운트다운을 이어서 수행한다.<br>
카운트다운이 0이 되는 순간 전송을 시작하며, 수신 측은 프레임을 정상적으로 수신한 경우 DIFS보다 짧은 SIFS 이후 ACK를 전송하여 송신 측이 성공 여부를 빠르게 판정할 수 있도록 한다.<br>
송신 측은 ACK를 수신하면 전송 성공으로 종료하고, ACK를 받지 못하면 충돌·잡음·숨은 노드 문제 등을 원인으로 전송 실패로 간주하여 데이터 프레임을 재전송한다.<br>
이때 수신 측이 전송하는 ACK 또한 충돌 또는 손실이 발생할 수 있으나, ACK 자체는 재전송하지 않으며 데이터 송신 측에서 데이터를 다시 전송하는 방식으로 처리한다.<br>

\* DIFS / SIFS / Slot Time: 802.11 표준에서 장치 내부에 규정해 둔 고정 시간값<br> \* DIFS (DCF Interframe Space): 채널이 비어 있어도 데이터 전송 노드가 경쟁을 시작하기 전에 반드시 기다려야 하는 최소 대기 시간<br> \* SIFS (Short Interframe Space): ACK/CTS 같은 즉시 응답 프레임을 우선 전송하기 위해 사용하는 가장 짧은 대기 시간<br> \* Slot Time: 채널 감지(확인) → 전송 시작까지 필요한 물리적 시간을 반영해 책정한 최소 시간 단위
